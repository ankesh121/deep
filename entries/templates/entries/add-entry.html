{% extends 'base.html' %}
{% load staticfiles %}

{% block title %}
DEEP | {% if entry %}Edit{% else %}Add{% endif %} Entry
{% endblock %}

{% block head %}

<link href="{% static 'css/add-entry.css' %}" type="text/css" rel="stylesheet">
<link href="{% static 'css/navigation-bar.css' %}" type="text/css" rel="stylesheet">
<link href="{% static 'css/selectize.css' %}" type="text/css" rel="stylesheet">
<link href="{% static 'css/selectize.bootstrap3.css' %}" type="text/css" rel="stylesheet">
<link href="{% static 'css/split-pane.css' %}" type="text/css" rel="stylesheet">

<script type="text/javascript" src="{% static 'js/selectize.js' %}"></script>
<script type="text/javascript" src="{% static 'js/split-pane.js' %}"></script>

<script type="text/javascript" src="{% static 'js/utils.js' %}"></script>

<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css">
<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>

<!-- <link rel="stylesheet" href="{% static 'css/leaflet.css' %}" />
<script src="{% static 'js/leaflet.js' %}"></script> -->

<link rel="stylesheet" href="{% static 'css/leaflet.label.css' %}" >
<script src="{% static 'js/leaflet.label.js' %}"></script>

<script>
    var leadSimplified = "{% if lead_simplified %}{{lead_simplified|escapejs}}{% endif %}";
    leadSimplified = leadSimplified.replace(/(?:\r\n|\r|\n)/g, '<br />');

    // var tags = {"one": ["we", "all"], "two": ["foolish", "apes"], "three": ["jackerwobly"]};
    var tags = {
        {% for sector in sectors %} "{{sector.name}}": {{sector.tags_json|safe}}, {% endfor %}
    };
    var selectedTags = {};
    var isSimplified;

    var mapSelections = [];
</script>

{% endblock %}

{% block body %}

{% include 'navigation-bar.html' %}

<div class="split-pane fixed-left">

    <div class="split-pane-component" id="left-component">
        {% if lead_simplified %}
        <div id="lead-options-container">
            <div class="btn-group" data-toggle="buttons" {% if lead.lead_type == 'MAN' %} style="display:none;" {% endif %}>
                <label class="btn btn-default radio-inline active"><input type="radio" name="lead-view-option" value="simplified" checked>Simplified</label>
                <label class="btn btn-default radio-inline"><input type="radio" name="lead-view-option" value="original">Original</label>
            </div>
            <div id="tag-buttons"></div>
        </div>
        {% endif %}

        <div id="lead-preview-container">
            {% if lead.lead_type == 'URL' %}
            <iframe id="lead-preview" src="{{ lead.url }}"></iframe>
            {% elif lead.lead_type == 'ATT' %}
            <iframe id="lead-preview" src="{{ lead.attachment.upload.url}}"></iframe>
            {% endif %}
            <div id="lead-simplified-preview">{{lead_simplified|safe|escape}}</div>
        </div>
    </div>

    <div class="split-pane-divider" id="my-divider"></div>

    <div class="split-pane-component" id="right-component">
        <div class="container-fluid">
            <div id="the-map" style="height:300px;"></div>

            <select name="country" id="country" placeholder="Select a country">
                <option value="">Select a country</option>
                {% for country in countries %}
                <option value="{{country.pk}}" {% if entry and entry.country == country %}selected{% endif %}>{{country.name}}</option>
                {% endfor %}
            </select>

            <div id="admin-level-buttons"></div>

            <div class="row">
                <div class="col-sm-12">
                    <div class="tree">
                        <ul>
                            <li>
                                <div class="checkbox"><label><input type="checkbox" name="all-population" id="all-population">All population</label></div>
                                <ul>
                                    <li>
                                        <div class="checkbox"><label><input type="checkbox" name="affected" id="affected">Affected</label></div>
                                        <ul>
                                            <li>
                                                <div class="checkbox"><label><input type="checkbox" name="displaced" id="displaced">Displaced</label></div>
                                                <ul>
                                                    <li><div class="checkbox" ><label><input type="checkbox" name="idp" id="idp">IDP</label></div></li>
                                                    <li><div class="checkbox" ><label><input type="checkbox" name="refugees" id="refugees">Refugees</label></div></li>
                                                    <li><div class="checkbox"><label><input type="checkbox" name="asylum-seekers" id="asylum-seekers">Asylum Seekers</label></div></li>
                                                    <li><div class="checkbox"><label><input type="checkbox" name="returnees" id="returnees">Returnees</label></div></li>
                                                    <li><div class="checkbox"><label><input type="checkbox" name="others" id="others">Others of Concern</label></div></li>
                                                </ul>
                                            </li>
                                            <li>
                                                <div class="checkbox"><label><input type="checkbox" name="non-displaced" id="non-displaced">Non-Displaced</label></div>
                                                <ul>
                                                    <li><div class="checkbox"><label><input type="checkbox" name="host" id="host">Host</label></div></li>
                                                    <li><div class="checkbox"><label><input type="checkbox" name="non-host" id="non-host">Non-Host</label></div></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li>
                                        <div class="checkbox"><label><input type="checkbox" name="non-affected" id="non-affected">Non-Affected</label></div>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-7">
                    <div class="tree">
                        <ul>
                            <li>
                                <div class="checkbox"><label><input type="checkbox" name="camp" id="camp">Camp/Camplike</label></div>
                                <ul>
                                    <li><div class="checkbox"><label><input type="checkbox" name="planned" id="planned">Planned</label></div></li>
                                    <li><div class="checkbox"><label><input type="checkbox" name="self-setteled" id="self-setteled">Self-setteled</label></div></li>
                                    <li><div class="checkbox"><label><input type="checkbox" name="collective-center" id="collective-center">Collective center</label></div></li>
                                    <li><div class="checkbox"><label><input type="checkbox" name="site" id="site">Reception/Transit site</label></div></li>
                                </ul>
                            </li>

                        </ul>
                    </div>
                </div>
                <div class="col-sm-5">
                    <div class="tree">
                        <ul>
                            <li>
                                <div class="checkbox"><label><input type="checkbox" name="accomodation" id="accomodation">Private/Individual Accomodation</label></div>
                                <ul>
                                    <li><div class="checkbox"><label><input type="checkbox" name="privately-hosted" id="privately-hosted">Privately Hosted</label></div></li>
                                    <li><div class="checkbox"><label><input type="checkbox" name="non-hosted" id="non-hosted">Non-Hosted</label></div></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div style="clear:both; padding:20px;" id="information-attributes">
            <h3> Information Attributes </h3>
            <div class="row">
                <div class="col-md-6">
                    <div class="attr-title">Context</div>
                    <div class="flexrow">
                        <div class="attr" data-attr-pk="hazard">Hazard Developments</div>
                        <div class="attr" data-attr-pk="lessons">Lessons Learned</div>
                        <div class="attr" data-attr-pk="stake">Stakeholders</div>
                        <div class="attr" data-attr-pk="hazard">Hazard Developments</div>
                        <div class="attr" data-attr-pk="lessons">Lessons Learned</div>
                        <div class="attr" data-attr-pk="stake">Stakeholders</div>
                    </div>

                    <div class="attr-title">Context</div>
                    <div class="flexrow">
                        <div class="attr" data-attr-pk="hazard">Hazard Developments</div>
                        <div class="attr" data-attr-pk="lessons">Lessons Learned</div>
                        <div class="attr" data-attr-pk="stake">Stakeholders</div>
                    </div>
                </div>

                <div class="col-md-6" id="attr-inputs">
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{% static 'js/add-entry.js' %}"></script>
<script src="{% static 'js/add-entry-map.js' %}"></script>

{% endblock %}
