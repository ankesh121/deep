{% extends 'base.html' %}
{% load staticfiles %}

{% block title %}
DEEP | {% if entry %}Edit{% else %}Add{% endif %} Entry
{% endblock %}

{% block head %}
<link href="{% static 'css/split-pane.css' %}" type="text/css" rel="stylesheet">
<link href="{% static 'css/add-entry.css' %}" type="text/css" rel="stylesheet">

<script type="text/javascript" src="{% static 'js/split-pane.js' %}"></script>
<script type="text/javascript" src="{% static 'js/utils.js' %}"></script>
<script type="text/javascript" src="{% static 'js/add-entry.js' %}"></script>

<!-- <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css">
<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script> -->

<!-- <link rel="stylesheet" href="{% static 'css/leaflet.label.css' %}" >
<script src="{% static 'js/leaflet.label.js' %}"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script> -->

<script>
    // Simplified version of the lead.
    var leadSimplified = "{% if lead_simplified %}{{lead_simplified|escapejs}}{% endif %}";
    leadSimplified = leadSimplified.replace(/(?:\r\n|\r|\n)/g, '<br />');
    // Is simplified option selected?
    var isSimplified;


</script>

{% endblock %}

{% block body %}
{% include 'navbar.html' %}
<div id="page-one">
    <div class="split-pane fixed-left">
        <div class="split-pane-component" id="left-component">

            {% if lead_simplified %}
            <div id="lead-options-container">
                <div class="row">
                    <div class="col-md-8">
                        <div class="btn-group" data-toggle="buttons" {% if lead.lead_type == 'MAN' %} style="display:none;" {% endif %}>
                            <label class="btn btn-default radio-inline active"><input type="radio" name="lead-view-option" value="simplified" checked>Simplified</label>
                            <label class="btn btn-default radio-inline"><input type="radio" name="lead-view-option" value="original">Original</label>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div id="zoom-buttons">
                            <button class="btn btn-regular btn-zoom" id="zoom-out" data-toggle="tooltip" title="zoom out"><i class="fa fa-search-minus"></i></button>
                            <button class="btn btn-regular btn-zoom" id="zoom-in" data-toggle="tooltip" title="zoom in"><i class="fa fa-search-plus"></i></button>
                            <div id="tag-buttons" style="max-height:200px; overflow:auto;"></div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <div id="lead-preview-container">
                {% if lead.lead_type == 'URL' %}
                <iframe id="lead-preview" src="{{ lead.url }}"></iframe>
                {% elif lead.lead_type == 'ATT' %}
                <iframe id="lead-preview" src="{{ lead.attachment.upload.url}}"></iframe>
                {% endif %}
                <div id="lead-simplified-preview">{{lead_simplified|safe|escape}}</div>
            </div>

        </div>
        <div class="split-pane-divider" id="divider"></div>
        <div class="split-pane-component" id="right-component">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-6">
                        <select class="form-control" placeholder="Select excerpt" id="select-excerpt">
                            <option>Excerpt 1</option>
                            <option>Excerpt 2</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <button class="btn btn-primary" id="add-excerpt"><i class="fa fa-plus"></i>Add excerpt</button>
                        <button class="btn btn-danger" id="delete-excerpt"><i class="fa fa-times"></i>Delete excerpt</button>
                    </div>
                    <div class="col-md-2">
                        <button class="btn btn-primary" id="edit-entries-btn">Edit Entries <i class="fa fa-long-arrow-right"></i></button>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <textarea class="form-control" id="excerpt-text" placeholder="Excerpt"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div id="matrix-one">

                            {% for pillar in pillars_one %}
                            <div class="pillar">
                                <div class="pillar-header">{{pillar}}</div>
                                {% for subpillar in pillar.informationsubpillar_set.all %}
                                <div class="sub-pillar" data-pillar-id="{{pillar.pk}}" data-subpillar-id="{{subpillar.pk}}">{{subpillar}}</div>
                                {% endfor %}
                            </div>
                            {% endfor %}

                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <table id="matrix-two">
                            <thead>
                                <td><td>
                                {% for sector in sectors %}
                                <td class="sector">{{sector}}</td>
                                {% endfor %}
                            </thead>
                            <tbody>
                                {% for pillar in pillars_two %}
                                {% for subpillar in pillar.informationsubpillar_set.all %}
                                <tr>
                                    {% if forloop.first %}
                                    <td class="pillar-header" style="background-color:{{pillar.background_color}};" rowspan="{{pillar.informationsubpillar_set.count}}">
                                        {{pillar}}
                                    </td>
                                    {% endif %}
                                    <td class="subpillar" style="background-color:{{pillar.background_color}};">{{subpillar}}</td>

                                    {% for sector in sectors %}<td class="attribute-block" data-pillar-id="{{pillar.pk}}" data-subpillar-id="{{subpillar.pk}}" data-sector-id="{{sector.pk}}" data-bk-color="{{pillar.background_color}}" data-active-bk-color="{{pillar.active_background_color}}"></td>{% endfor %}
                                </tr>
                                {% endfor %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="page-two" hidden>
    <div class="container-fluid">
        <div style="text-align: right">
            <button id="back-to-excerpts-btn"  class="btn btn-primary"><i class="fa fa-long-arrow-left"></i>Back to excerpts</button>
        </div>
        <div id="entries">
        </div>
    </div>
</div>

<!--
excerpt-template -> excerpt
vulnerable-group-select
specific-need-group-select
specific-needs-group-list
geo-locations-list
attribute-list

attribute-template -> attribute
pillar
sub-pillar
sector
sub-sector
 -->

<div class="entry-template" hidden>
    <div class="row">
        <div class="col-md-3">
            <textarea class="form-control excerpt" ></textarea>
        </div>
        <div class="col-md-1">
            <div class="reliability">
                <label>Reliability </label><br>
                <span class="_1"></span>
                <span class="_2"></span>
                <span class="_3"></span>
                <span class="_4"></span>
                <span class="_5"></span>
            </div>
            <div class="severity">
                <label>Severity </label><br>
                <span class="_1"></span>
                <span class="_2"></span>
                <span class="_3"></span>
                <span class="_4"></span>
                <span class="_5"></span>
            </div>
        </div>
        <div class="col-md-1">
            <input type="text" class="form-control form-group" placeholder="Date">
            <input type="text" class="form-control form-group" placeholder="Number">
        </div>
        <div class="col-md-2">
            <select class="vulnerable-group-select" class="form-control form-group" placeholder="Select vulnerable group"></select>
            <select class="specific-need-group-select" class="form-control form-group" placeholder="Select specific need group"></select>
        </div>
        <div class="col-md-5">
            <div class="row">
                <div class="col-md-5">
                    <div class="specific-needs-group">
                        <label>Specific needs groups:</label><a class="btn btn-primary btn-sm"><i class="fa fa-line-chart"></i></a>
                        <div class="specific-needs-group-list"></div>
                    </div>
                    <div class="geo-location">
                        <label>Geo locations:</label><a class="btn btn-primary btn-sm"><i class="fa fa-map"></i></a>
                        <div class="geo-locations-list"></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="attribute-list">
                    </div>
                </div>
                <div class="col-md-1">
                    <a class="btn btn-primary btn-action"><i class="fa fa-edit"></i></a>
                    <a class="btn btn-danger btn-action"><i class="fa fa-times"></i></a>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="attribute-template" hidden>
    <div class="row">
        <div class="col-md-6">
            <span class="pillar"></span> / <span class="sub-pillar"></span>
        </div>
        <div class="col-md-6">
            <span class="sector"></span> / <a class="pillar"></a>
        </div>
    </div>
</div>
{% endblock %}
